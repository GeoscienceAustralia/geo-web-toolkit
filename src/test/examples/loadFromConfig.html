<!DOCTYPE html>
<html ng-app="simpleMap">
<head lang="en">
    <meta charset="UTF-8">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/proj4js/2.2.1/proj4.js"></script>
    <script src="../../../node_modules/openlayers/dist/ol-debug.js"></script>
    <script src="http://dev.openlayers.org/OpenLayers.js"></script>
    <script src="../../../bower_components/jquery/dist/jquery.js"></script>
    <script src="../../../bower_components/angular/angular.js"></script>
    <script src="../../main/js/geo-web-toolkit-min.js"></script>
    <script src="http://epsg.io/21781-1753.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../../../node_modules/openlayers/dist/ol-debug.css"/>
    <script src="http://maps.google.com/maps/api/js?sensor=false&.js&libraries=places"></script>
    <title>OpenLayers 3 Example Map</title>
</head>
<body ng-controller="mainController">
<h1 id="test111" ng-bind="frameworkName"></h1>
<div id="map" style="width:100%;height:500px;"></div>
<!-- Investigate bug limiting fullscreen size. WIDTH and HEIGHT values seem to be using size of window. -->
<div ng-if="configReady">
    <div >
        <ga-map ng-if="frameworkType != null" map-element-id="map" framework="{{frameworkType}}" datum-projection="{{gaConfig.datumProjection}}"
                display-projection="{{gaConfig.displayProjection}}"
                center-position="{{gaConfig.centerPosition}}"
                zoom-level="{{gaConfig.zoomLevel}}"
                initial-extent="gaConfig.initialExtent">
            <ga-map-layer ng-repeat="baseLayer in gaConfig.baseMaps"
                          layer-name="{{baseLayer.name}}"
                          layer-url="{{baseLayer.url}}"
                          wrap-date-line="{{baseLayer.wrapDateLine}}"
                          layer-type="{{baseLayer.mapType}}"
                          layers="{{baseLayer.layers}}"
                          is-base-layer="true"
                          visibility="{{baseLayer.visibility}}"
                          layer-attribution="{{baseLayer.attribution}}"
                          refresh-layer="{{layer.refresh}}"
                          max-zoom-level="{{baseLayer.maxZoomLevel}}"
                          on-error="onBaseLayerError(message,layer)">
            </ga-map-layer>

            <ga-map-layer ng-repeat="layer in gaConfig.layerMaps"
                          layer-name="{{layer.name}}"
                          layer-url="{{layer.url}}"
                          wrap-date-line="{{layer.wrapDateLine}}"
                          layer-type="{{layer.mapType}}"
                          layers="{{layer.layers}}"
                          visibility="{{layer.visibility}}"
                          opacity="{{layer.opacity}}"
                          refresh-layer="{{layer.refresh}}"
                          max-zoom-level="{{layer.maxZoomLevel}}"
                          on-error="onLayerError(message,layer)">
            </ga-map-layer>



            <ga-map-control map-control-name="attribution"></ga-map-control>
            <ga-map-control map-control-name="mouseposition"></ga-map-control>



        </ga-map>
    </div>
</div>
<script>
    var app = angular.module('simpleMap',['gawebtoolkit.core']);

    app.controller('mainController', ['$scope','$timeout', function ($scope,$timeout) {
        $scope.$on('mapControllerReady', function (mapController) {
            console.log(mapController);
            $scope.mapController = mapController;
        });
        $scope.frameworkType = 'olv2';
        $scope.frameworkName = 'OpenLayers 2';
        $('#test111').on('click', function () {
            $scope.$apply(function () {
                $scope.frameworkTypeOldVal = angular.copy($scope.frameworkType);
                $scope.frameworkType = null;
                $timeout(function () {
                    $scope.frameworkType = $scope.frameworkTypeOldVal == 'olv2' ? 'olv3' : 'olv2';
                    $scope.frameworkName = $scope.frameworkTypeOldVal == 'olv2' ? 'OpenLayers 3' : 'OpenLayers 2';
                },10)
            });
        });

        $scope.gaConfig = {
            "id": "twi",
            "title": "Treaties with Indonesia",
            "datumProjection": "EPSG:102100",
            "displayProjection": "EPSG:4326",
            "initialExtent": [
                [85, 10],
                [155, -25]
            ],
            "requiresTermsAndConditions" : true,
            "termsAndConditionsUrl": "content/amsis/termsAndConditions.html",
            "headerConfig": {
                "title": "Treaties with Indonesia"
            },
            "cookieExpirationInDays": 7,
            "termsAndConditionsCookieName": "amsis",
            "aboutConfig": {
                "enabled": true,
                "bodyUrl": "content/amsis/twi/about.html"
            },
            "layersConfig": {
                "enabled": true
            },
            "baseLayersConfig": {
                "enabled": true
            },
            "legendConfig": {
                "enabled": true,
                "legendUrl": "content/amsis/twi/legend.html"
            },
            "baseMaps": [
                {
                    "mapType": "XYZTileCache",
                    "visibility": true,
                    "name": "World Image",
                    "url": "http://www.ga.gov.au/gisimg/rest/services/topography/World_Bathymetry_Image_WM/MapServer",
                    "opacity": 1.0,
                    "wrapDateLine": true,
                    "maxZoomLevel" : 12,
                    "attribution": "Geoscience Australia <a target='_blank' href='http://creativecommons.org/licenses/by/3.0/au/deed.en'>CC-By-Au</a> and Natural Earth <a target='_blank' href='http://www.naturalearthdata.com/about/'>Terms of Use</a>"
                },
                {
                    "mapType": "XYZTileCache",
                    "visibility": false,
                    "name": "World Political Boundaries",
                    "url": "http://www.ga.gov.au/gis/rest/services/topography/World_Political_Boundaries_WM/MapServer",
                    "opacity": 1.0,
                    "wrapDateLine": true,
                    "attribution": "World Political Boundaries <a target='_blank' href='http://www.naturalearthdata.com/'>Natural Earth</a>"
                }
            ],
            "layerMaps": [
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia Perth Treaty Area of Overlapping Jurisdiction AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_Perth_Treaty_Area_of_Overlapping_Jurisdiction_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_Perth_Treaty_1997_Area_of_Overlapping_Jurisdiction_Area",
                    "metadataText": "Treaty between the Government of Australia and the Government of the Republic of Indonesia establishing an Exclusive Economic Zone Boundary and Certain Seabed Boundaries (Perth, 14 march 1997) [1997] ATNIF 9 - Area of overlapping jurisdiction over which Australia exercises sovereign rights over the seabed and Indonesia soveregn rights over the water column. Services created from the original treaty documents and densified using the line geometry defined in the treaty (geodesic or loxodrome) with a vertex placed at least every 0.5 nautical miles. This will ensure the geometry of the lines is preserved regardless of projection utilised by a Geographic Information System. Where the original datum of the treaty is not specified as GDA94, all defined points have been transformation by Geoscience Australia's National Geospatial Reference Systems Section to GDA94.",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_Perth_Treaty_Area_of_Overlapping_Jurisdiction_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_Perth_Treaty_Area_of_Overlapping_Jurisdiction_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_Perth_Treaty_Area_of_Overlapping_Jurisdiction_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 0.5,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_Perth_Treaty_Area_of_Overlapping_Jurisdiction_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_Perth_Treaty_1997_Area_of_Overlapping_Jurisdiction_Area"
                },
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia Provisional Fisheries Surveillance and Enforcement Line AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_PFSEL_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_Provisional_Fisheries_Surveillance_and_Enforcement_Line_AMB2014_Points,Indonesia_Provisional_Fisheries_Surveillance_and_Enforcement_Line_AMB2014_Limit",
                    "metadataText": "Memorandum of Understanding Indonesia Traditional Fisherman 1974, MOU Indonesia PFSEL 1981 (PFSEL). Services created from the original treaty documents and densified using the line geometry defined in the treaty (geodesic or loxodrome) with a vertex placed at least every 0.5 nautical miles. This will ensure the geometry of the lines is preserved regardless of projection utilised by a Geographic Information System. Where the original datum of the treaty is not specified as GDA94, all defined points have been transformation by Geoscience Australia's National Geospatial Reference Systems Section to GDA94",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_PFSEL_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_PFSEL_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_PFSEL_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 1.0,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_PFSEL_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_Provisional_Fisheries_Surveillance_and_Enforcement_Line_AMB2014_Points,Indonesia_Provisional_Fisheries_Surveillance_and_Enforcement_Line_AMB2014_Limit"
                },
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia 1997 Exclusive Economic Zone AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_EEZ_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_Perth_Treaty_1997_Exclusive_Economic_Zone_AMB2014_Points,Indonesia_Perth_Treaty_1997_Exclusive_Economic_Zone_AMB2014_Line",
                    "metadataText": "Treaty between the Government of Australia and the Government of the Republic of Indonesia establishing an Exclusive Economic Zone Boundary and Certain Seabed Boundaries (Perth, 14 march 1997) [1997] ATNIF 9 - Line delimiting the exclusive economic zone boundary between Australia and Indonesia. Services created from the original treaty documents and densified using the line geometry defined in the treaty (geodesic or loxodrome) with a vertex placed at least every 0.5 nautical miles. This will ensure the geometry of the lines is preserved regardless of projection utilised by a Geographic Information System. Where the original datum of the treaty is not specified as GDA94, all defined points have been transformation by Geoscience Australia's National Geospatial Reference Systems Section to GDA94.",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_EEZ_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_EEZ_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_EEZ_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 1.0,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_EEZ_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_Perth_Treaty_1997_Exclusive_Economic_Zone_AMB2014_Points,Indonesia_1971_Seabed_Treaty_AMB2014_Line"
                },
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia 1997 Perth Treaty Seabed AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_Seabed_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_Perth_Treaty_1997_Seabed_AMB2014_Points,Indonesia_Perth_Treaty_1997_Seabed_AMB2014_Limit",
                    "metadataText": "Treaty between the Government of Australia and the Government of the Republic of Indonesia establishing an Exclusive Economic Zone Boundary and Certain Seabed Boundaries (Perth, 14 march 1997) [1997] ATNIF 9 - Western Extension of the seabed boundary.",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_Seabed_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_Seabed_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_Seabed_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 1.0,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_1997_Perth_Treaty_Seabed_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_Perth_Treaty_1997_Seabed_AMB2014_Points,Indonesia_Perth_Treaty_1997_Seabed_AMB2014_Line"
                },
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia Memorandum of Understanding AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_MOU_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_Memorandum_of_Understanding_AMB2014_Points,Indonesia_Memorandum_of_Understanding_AMB2014_Limit",
                    "metadataText": "Memorandum of Understanding between the Governments of Australia and the Government of the Republic of Indonesia regarding the Operations of Indonesian Traditional Fisherman in Areas of the Australian Exclusive Fishing Zone and Continental Shelf 1974. Services created from the original treaty documents and densified using the line geometry defined in the treaty (geodesic or loxodrome) with a vertex placed at least every 0.5 nautical miles. This will ensure the geometry of the lines is preserved regardless of projection utilised by a Geographic Information System. Where the original datum of the treaty is not specified as GDA94, all defined points have been transformation by Geoscience Australia's National Geospatial Reference Systems Section to GDA94.",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_MOU_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_MOU_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_MOU_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 1.0,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_MOU_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_Memorandum_of_Understanding_AMB2014_Points,Indonesia_Memorandum_of_Understanding_AMB2014_Limit"
                },
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia 1972 Seabed AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1972_Seabed_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_1972_Seabed_Treaty_AMB2014_Points,Indonesia_1972_Seabed_Treaty_AMB2014_Limit",
                    "metadataText": "Agreement between the Government of the Commonwealth of Australia and the Government of the Republic of Indonesia establishing Certain Seabed Boundaries in the Area of the Timor and Arafura Seas, supplementary to the Agreement of 18 May 1971 (Jakarta, 9 October 1972) [1973] ATS 32.",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_1972_Seabed_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1972_Seabed_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1972_Seabed_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 1.0,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_1972_Seabed_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_1972_Seabed_Treaty_AMB2014_Points,Indonesia_1972_Seabed_Treaty_AMB2014_Limit"
                },
                {
                    "mapType": "WMS",
                    "visibility": true,
                    "name": "Treaty Indonesia 1971 Seabed AMB 2014",
                    "url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1971_Seabed_AMB2014/MapServer/WMSServer",
                    "layers": "Indonesia_1971_Seabed_Treaty_AMB2014_Points,Indonesia_1971_Seabed_Treaty_AMB2014_Limit",
                    "metadataText": "Agreement between the Government of the Commonwealth of Australia and the Government of the Republic of Indonesia establishing Certain Seabed Boundaries (Canberra, 18 May 1971) [1973] ATS 31.",
                    "ogcLinks" : [{"description": "REST","url": "http://www.ga.gov.au/gis/rest/services/legislation/Treaty_Indonesia_1971_Seabed_AMB2014/MapServer"},
                        {"description": "WMS Capabilities","url": "http://www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1971_Seabed_AMB2014/MapServer/WMSServer?request=GetCapabilities&service=WMS"},
                        {"description": "ArcMap Layerfile","url": "http:/www.ga.gov.au/gis/services/legislation/Treaty_Indonesia_1971_Seabed_AMB2014/MapServer?f=lyr&v=9.3"}],
                    "opacity": 1.0,
                    "queryFeatures" : true,
                    "queryUrl": "/gis/services/legislation/Treaty_Indonesia_1971_Seabed_AMB2014/MapServer/WMSServer",
                    "queryUrlType":"WMS",
                    "queryVersion": "1.1.1",
                    "queryLayers": "Indonesia_1971_Seabed_Treaty_AMB2014_Points,Indonesia_1971_Seabed_Treaty_AMB2014_Limit"
                }
            ]
        };
        $scope.configReady = true;

    }]);

</script>

</body>
</html>